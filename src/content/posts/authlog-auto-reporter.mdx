---
title: "AuthLog Auto Reporter: res√∫menes r√°pidos de auth.log"
pubDate: "2025-02-10"
description: "Script en Python que analiza auth.log y genera un informe en Markdown con IPs atacantes, usuarios m√°s atacados y logins aceptados."
tags: ["blue-team", "python", "linux", "logs", "automation"]
heroImage: "/images/authlog-auto/authlog-auto.png"
---

En este art√≠culo explico c√≥mo funciona **AuthLog Auto Reporter** üßæ, una herramienta en Python pensada para ayudar a un analista SOC a **resumir r√°pidamente lo m√°s importante** de un fichero `auth.log` (SSH, sudo, autenticaci√≥n) sin tener que leer cientos de l√≠neas a mano.

---

## üß† Contexto: ¬øpor qu√© este proyecto?

En un SOC es muy habitual encontrarse alertas del tipo:

- *M√∫ltiples intentos fallidos de SSH desde una misma IP.*
- *Posible fuerza bruta contra cuentas del sistema.*
- *Acceso SSH exitoso desde una IP poco habitual.*

Cuando esto ocurre, casi siempre acabamos en el mismo sitio:  
‚û°Ô∏è **`/var/log/auth.log`** (o equivalente seg√∫n la distro).

El problema es que:

- El log suele ser **muy ruidoso**.
- Hay muchos eventos repetidos.
- Es f√°cil perderse entre intentos fallidos, sesiones abiertas, sudo, etc.

La idea de AuthLog Auto Reporter es muy sencilla:

> ‚ÄúDame un `auth.log` y te devuelvo un **resumen en Markdown listo para pegar en el ticket** del incidente.‚Äù

---

## üîç ¬øQu√© problema resuelve?

En lugar de revisar el `auth.log` l√≠nea a l√≠nea, el script:

- üî¢ **Agrupa las IPs** con m√°s intentos de login fallidos.
- üë§ Muestra los **usuarios m√°s atacados**.
- ‚úÖ Lista los **logins aceptados**, para revisar accesos leg√≠timos o sospechosos.
- üìÑ Genera todo en un **informe Markdown** con tablas que se puede pegar directamente en:
  - un ticket del SOC,
  - un informe t√©cnico,
  - o en una wiki interna.

Esto ahorra tiempo al analista y, sobre todo, **estandariza** la forma de documentar estos casos.

---

## ‚öôÔ∏è Flujo de uso

1. Exportar o copiar el `auth.log` que quieras analizar:

   ```bash
   sudo cp /var/log/auth.log samples/auth.log

## üßæ Ejemplo de informe generado

A continuaci√≥n tienes un ejemplo real de informe Markdown generado por la herramienta a partir del fichero `samples/auth.log`:

```markdown
# AuthLog Auto Reporter

Informe generado autom√°ticamente a partir del fichero:

- **Fichero analizado**: `samples/auth.log`
- **Periodo observado**: 2025-01-10 10:10:10 -> 2025-01-10 10:13:13

## Top IPs con intentos de login fallidos

| IP      | Intentos fallidos |
|---------|-------------------|
| 1.2.3.4 | 1                 |
| 5.6.7.8 | 1                 |
| 10.0.0.5| 1                 |

## Usuarios m√°s atacados (intentos fallidos)

| Usuario | Intentos fallidos |
|--------|-------------------|
| test   | 1                 |
| root   | 1                 |
| admin  | 1                 |

## Usuarios con logins aceptados

| Usuario | Logins aceptados |
|--------|-------------------|
| nacho  | 1                 |

_Consejo_: copia este informe en el ticket del SOC y a√±ade detalles del caso
(alerta original, acciones de contenci√≥n, bloqueo de IPs, etc.).
